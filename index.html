<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weekly Task Planner</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0d0d;
    --card: #141414;
    --border: #222;
    --text: #f8f8f8;
    --muted: #555;
    --input-bg: #1a1a1a;

    --teaching:    #FF3E5E;
    --amatyc:      #FF7A00;
    --curriculum:  #F5C400;
    --fused:       #00D48A;
    --spanish:     #00BBFF;
    --utd:         #5B8EFF;
    --prolearning: #A78BFA;
    --personal:    #F472B6;
    --faculty:     #94A3B8;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    padding: 36px 28px 60px;
  }

  /* ── HEADER ── */
  header {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 16px;
    margin-bottom: 36px;
    animation: fadeDown 0.6s ease both;
  }

  .header-left h1 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: clamp(2.4rem, 5vw, 4rem);
    letter-spacing: 0.08em;
    line-height: 1;
    background: linear-gradient(135deg, #FF3E5E, #FF7A00, #F5C400, #00D48A, #00BBFF);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .header-left p {
    color: var(--muted);
    font-size: 0.78rem;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    margin-top: 5px;
  }

  .week-picker {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 6px;
  }

  .week-picker label {
    font-size: 0.7rem;
    color: var(--muted);
    letter-spacing: 0.15em;
    text-transform: uppercase;
  }

  .week-picker input[type="date"] {
    background: var(--input-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.9rem;
    padding: 8px 14px;
    outline: none;
    cursor: pointer;
    transition: border-color 0.2s;
  }

  .week-picker input[type="date"]:focus {
    border-color: #444;
  }

  /* ── PROGRESS BAR ── */
  .progress-bar-wrap {
    margin-bottom: 32px;
    animation: fadeIn 0.8s ease 0.2s both;
  }

  .progress-meta {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
  }

  .progress-meta span {
    font-size: 0.72rem;
    color: var(--muted);
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  .progress-meta strong {
    color: var(--text);
  }

  .bar-outer {
    height: 6px;
    background: #1e1e1e;
    border-radius: 6px;
    overflow: hidden;
  }

  .bar-inner {
    height: 100%;
    border-radius: 6px;
    background: linear-gradient(90deg, #FF3E5E, #FF7A00, #F5C400, #00D48A, #00BBFF);
    transition: width 0.4s ease;
    width: 0%;
  }

  /* ── GRID ── */
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 18px;
  }

  /* ── CATEGORY CARD ── */
  .cat-card {
    background: var(--card);
    border-radius: 16px;
    overflow: hidden;
    border: 1px solid #1c1c1c;
    animation: fadeUp 0.6s ease both;
    transition: box-shadow 0.2s;
  }

  .cat-card:hover {
    box-shadow: 0 6px 28px rgba(0,0,0,0.5);
  }

  .cat-header {
    padding: 16px 18px 12px;
    border-left: 4px solid var(--accent);
    position: relative;
    overflow: hidden;
  }

  .cat-header::after {
    content: '';
    position: absolute;
    top: -20px; right: -20px;
    width: 80px; height: 80px;
    border-radius: 50%;
    background: var(--accent);
    opacity: 0.08;
  }

  .cat-title-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .cat-name {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.3rem;
    letter-spacing: 0.06em;
    color: var(--accent);
    line-height: 1;
  }

  .cat-hrs {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.5rem;
    color: var(--accent);
    opacity: 0.85;
    line-height: 1;
  }

  .cat-sub {
    font-size: 0.72rem;
    color: var(--muted);
    margin-top: 3px;
  }

  .cat-done-count {
    font-size: 0.68rem;
    color: var(--muted);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-top: 6px;
  }

  .cat-done-count span {
    color: var(--accent);
    font-weight: 600;
  }

  /* ── MINI PROGRESS ── */
  .mini-bar {
    height: 3px;
    background: #222;
    margin: 10px 18px 0;
    border-radius: 3px;
    overflow: hidden;
  }

  .mini-bar-fill {
    height: 100%;
    background: var(--accent);
    border-radius: 3px;
    transition: width 0.3s ease;
    width: 0%;
  }

  /* ── TASKS ── */
  .tasks {
    padding: 12px 14px 14px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .task-row {
    display: flex;
    align-items: center;
    gap: 10px;
    background: var(--input-bg);
    border-radius: 10px;
    padding: 9px 12px;
    border: 1px solid transparent;
    transition: border-color 0.2s, background 0.2s;
  }

  .task-row:focus-within {
    border-color: var(--accent);
    background: #1e1e1e;
  }

  .task-row.done-row {
    opacity: 0.45;
  }

  /* custom checkbox */
  .check-wrap {
    position: relative;
    flex-shrink: 0;
    width: 18px;
    height: 18px;
  }

  .check-wrap input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 100%;
    height: 100%;
    cursor: pointer;
    z-index: 2;
  }

  .check-box {
    position: absolute;
    inset: 0;
    border: 2px solid var(--accent);
    border-radius: 5px;
    background: transparent;
    transition: background 0.15s;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .check-box svg {
    opacity: 0;
    transition: opacity 0.15s;
    width: 10px; height: 10px;
  }

  .check-wrap input:checked ~ .check-box {
    background: var(--accent);
  }

  .check-wrap input:checked ~ .check-box svg {
    opacity: 1;
  }

  .task-input {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.85rem;
    line-height: 1.4;
    caret-color: var(--accent);
  }

  .task-input::placeholder {
    color: #333;
  }

  .task-input.done-text {
    text-decoration: line-through;
    color: var(--muted);
  }

  /* add task button */
  .add-task-btn {
    display: flex;
    align-items: center;
    gap: 7px;
    background: none;
    border: 1px dashed #2a2a2a;
    border-radius: 10px;
    color: #333;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.78rem;
    padding: 7px 12px;
    cursor: pointer;
    width: 100%;
    transition: border-color 0.2s, color 0.2s;
    letter-spacing: 0.05em;
  }

  .add-task-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
  }

  .add-task-btn svg {
    flex-shrink: 0;
  }

  /* ── NOTES ── */
  .notes-section {
    padding: 0 14px 14px;
  }

  .notes-toggle {
    display: flex;
    align-items: center;
    gap: 6px;
    background: none;
    border: none;
    color: var(--muted);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.72rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    cursor: pointer;
    padding: 4px 0;
    transition: color 0.2s;
    width: 100%;
    text-align: left;
  }

  .notes-toggle:hover { color: var(--accent); }

  .notes-toggle .toggle-arrow {
    display: inline-block;
    transition: transform 0.2s;
    font-size: 0.65rem;
  }

  .notes-toggle.open .toggle-arrow { transform: rotate(90deg); }

  .notes-body { display: none; margin-top: 8px; }
  .notes-body.open { display: block; }

  .notes-textarea {
    width: 100%;
    min-height: 72px;
    background: var(--input-bg);
    border: 1px solid transparent;
    border-radius: 10px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.82rem;
    line-height: 1.55;
    padding: 10px 12px;
    resize: vertical;
    outline: none;
    caret-color: var(--accent);
    transition: border-color 0.2s;
  }

  .notes-textarea::placeholder { color: #333; }
  .notes-textarea:focus { border-color: var(--accent); }

  /* ── FOOTER ── */
  footer {
    text-align: center;
    margin-top: 44px;
    font-size: 0.68rem;
    color: #2a2a2a;
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  /* ── CLEAR BUTTON ── */
  .clear-btn {
    background: none;
    border: 1px solid #222;
    border-radius: 8px;
    color: var(--muted);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.72rem;
    padding: 7px 14px;
    cursor: pointer;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    transition: border-color 0.2s, color 0.2s;
  }

  .clear-btn:hover {
    border-color: #FF3E5E;
    color: #FF3E5E;
  }

  @keyframes fadeDown { from { opacity:0; transform:translateY(-16px); } to { opacity:1; transform:none; } }
  @keyframes fadeUp   { from { opacity:0; transform:translateY(16px);  } to { opacity:1; transform:none; } }
  @keyframes fadeIn   { from { opacity:0; } to { opacity:1; } }
</style>
</head>
<body>

<header>
  <div class="header-left">
    <h1>Weekly Task Planner</h1>
    <p>Organized by focus area · Check off as you go</p>
  </div>
  <div class="week-picker">
    <label>Week of</label>
    <input type="date" id="week-date">
    <button class="clear-btn" id="clear-btn">Clear All Tasks</button>
  </div>
</header>

<div class="progress-bar-wrap">
  <div class="progress-meta">
    <span>Overall Progress</span>
    <span><strong id="done-count">0</strong> of <strong id="total-count">0</strong> tasks complete</span>
  </div>
  <div class="bar-outer"><div class="bar-inner" id="global-bar"></div></div>
</div>

<div class="grid" id="grid"></div>

<footer>Your week · Your priorities · Your design</footer>

<script>
const CATEGORIES = [
  { id:'teaching',    name:'Teaching',        sub:'Calc 1 · Int. Algebra · IAA · MBA', hrs:'28h', color:'#FF3E5E', slots:5 },
  { id:'amatyc',      name:'AMATYC',           sub:'Conference Coordinator · Board',    hrs:'13h', color:'#FF7A00', slots:4 },
  { id:'curriculum',  name:'Curriculum Dev',   sub:'IAA · MOF · MBA',                  hrs:'11h', color:'#F5C400', slots:4 },
  { id:'fused',       name:'Fused Glass',      sub:'Weekly Class · Curriculum',         hrs:'6h',  color:'#00D48A', slots:3 },
  { id:'spanish',     name:'Spanish',          sub:'Language Learning · Personal Growth',hrs:'4h', color:'#00BBFF', slots:3 },
  { id:'utd',         name:'UTD Mentoring',    sub:'University Transfer Students',      hrs:'3h',  color:'#5B8EFF', slots:2 },
  { id:'prolearning', name:'Prof. Learning',   sub:'Reading · Courses · Growth',        hrs:'2h',  color:'#A78BFA', slots:2 },
  { id:'personal',    name:'Personal',         sub:'Fun · Rest · Creative Play',        hrs:'2h',  color:'#F472B6', slots:2 },
  { id:'faculty',     name:'Faculty Assoc.',   sub:'Treasurer · Membership Chair',      hrs:'1h',  color:'#94A3B8', slots:2 },
];

const STORAGE_KEY = 'weekly-planner-v1';

function loadState() {
  try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}; } catch { return {}; }
}

function saveState() {
  const state = { date: document.getElementById('week-date').value, categories: {} };
  CATEGORIES.forEach(cat => {
    const card = document.querySelector(`[data-cat="${cat.id}"]`);
    const rows = card.querySelectorAll('.task-row');
    const textarea = card.querySelector('.notes-textarea');
    const notesOpen = card.querySelector('.notes-body')?.classList.contains('open') || false;
    state.categories[cat.id] = {
      tasks: Array.from(rows).map(r => ({
        text: r.querySelector('.task-input').value,
        done: r.querySelector('input[type="checkbox"]').checked
      })),
      notes: textarea ? textarea.value : '',
      notesOpen
    };
  });
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  updateProgress();
}

function buildCard(cat, savedTasks) {
  const card = document.createElement('div');
  card.className = 'cat-card';
  card.dataset.cat = cat.id;
  card.style.setProperty('--accent', cat.color);
  card.style.animationDelay = `${CATEGORIES.indexOf(cat) * 0.05}s`;

  card.innerHTML = `
    <div class="cat-header">
      <div class="cat-title-row">
        <div class="cat-name">${cat.name}</div>
        <div class="cat-hrs">${cat.hrs}</div>
      </div>
      <div class="cat-sub">${cat.sub}</div>
      <div class="cat-done-count"><span class="done-num">0</span> / <span class="total-num">0</span> done</div>
    </div>
    <div class="mini-bar"><div class="mini-bar-fill"></div></div>
    <div class="tasks" id="tasks-${cat.id}"></div>
  `;

  const tasksEl = card.querySelector(`#tasks-${cat.id}`);

  // Render saved tasks or default empty slots
  const taskData = (savedTasks?.tasks) || savedTasks || Array.from({length: cat.slots}, () => ({text:'', done:false}));
  taskData.forEach(t => addTaskRow(tasksEl, cat, t.text, t.done));

  // Add task button
  const addBtn = document.createElement('button');
  addBtn.className = 'add-task-btn';
  addBtn.innerHTML = `<svg width="12" height="12" viewBox="0 0 12 12" fill="none"><line x1="6" y1="1" x2="6" y2="11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><line x1="1" y1="6" x2="11" y2="6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg> Add task`;
  addBtn.addEventListener('click', () => { addTaskRow(tasksEl, cat, '', false); saveState(); updateCardProgress(card, cat); });
  tasksEl.appendChild(addBtn);

  // Notes section
  const notesSection = document.createElement('div');
  notesSection.className = 'notes-section';
  notesSection.innerHTML = `
    <button class="notes-toggle">
      <span class="toggle-arrow">▶</span> Notes
    </button>
    <div class="notes-body">
      <textarea class="notes-textarea" placeholder="Jot down context, reminders, or anything relevant for this area this week…"></textarea>
    </div>
  `;

  const toggle = notesSection.querySelector('.notes-toggle');
  const body = notesSection.querySelector('.notes-body');
  const textarea = notesSection.querySelector('.notes-textarea');

  // Restore saved notes + open state
  if (savedTasks?.notes !== undefined) textarea.value = savedTasks.notes;
  if (savedTasks?.notesOpen) { body.classList.add('open'); toggle.classList.add('open'); }

  toggle.addEventListener('click', () => {
    body.classList.toggle('open');
    toggle.classList.toggle('open');
    saveState();
  });

  textarea.addEventListener('input', saveState);
  card.appendChild(notesSection);

  return card;
}

function addTaskRow(tasksEl, cat, text, done) {
  const row = document.createElement('div');
  row.className = 'task-row' + (done ? ' done-row' : '');

  row.innerHTML = `
    <label class="check-wrap">
      <input type="checkbox" ${done ? 'checked' : ''}>
      <div class="check-box">
        <svg viewBox="0 0 10 10" fill="none">
          <polyline points="1.5,5 4,7.5 8.5,2.5" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    </label>
    <input class="task-input${done ? ' done-text' : ''}" type="text" placeholder="Enter task…" value="${text.replace(/"/g, '&quot;')}">
  `;

  const checkbox = row.querySelector('input[type="checkbox"]');
  const input = row.querySelector('.task-input');

  checkbox.addEventListener('change', () => {
    row.classList.toggle('done-row', checkbox.checked);
    input.classList.toggle('done-text', checkbox.checked);
    reorderTasks(tasksEl);
    saveState();
    const card = row.closest('.cat-card');
    updateCardProgress(card, cat);
  });

  input.addEventListener('input', saveState);

  // Insert before the Add button (last child)
  const addBtn = tasksEl.querySelector('.add-task-btn');
  if (addBtn) tasksEl.insertBefore(row, addBtn);
  else tasksEl.appendChild(row);
}

function reorderTasks(tasksEl) {
  const addBtn = tasksEl.querySelector('.add-task-btn');
  const rows = Array.from(tasksEl.querySelectorAll('.task-row'));
  const unchecked = rows.filter(r => !r.querySelector('input[type="checkbox"]').checked);
  const checked   = rows.filter(r =>  r.querySelector('input[type="checkbox"]').checked);
  [...unchecked, ...checked].forEach(r => tasksEl.insertBefore(r, addBtn));
}

function updateCardProgress(card, cat) {
  const rows = card.querySelectorAll('.task-row');
  const total = rows.length;
  const done = Array.from(rows).filter(r => r.querySelector('input[type="checkbox"]').checked).length;
  card.querySelector('.done-num').textContent = done;
  card.querySelector('.total-num').textContent = total;
  const pct = total > 0 ? (done / total) * 100 : 0;
  card.querySelector('.mini-bar-fill').style.width = pct + '%';
}

function updateProgress() {
  let total = 0, done = 0;
  document.querySelectorAll('.task-row').forEach(r => {
    total++;
    if (r.querySelector('input[type="checkbox"]').checked) done++;
  });
  document.getElementById('done-count').textContent = done;
  document.getElementById('total-count').textContent = total;
  document.getElementById('global-bar').style.width = total > 0 ? (done / total * 100) + '%' : '0%';
  document.querySelectorAll('.cat-card').forEach((card, i) => {
    updateCardProgress(card, CATEGORIES[i]);
  });
}

// ── INIT ──
const grid = document.getElementById('grid');
const state = loadState();

if (state.date) document.getElementById('week-date').value = state.date;

CATEGORIES.forEach(cat => {
  const saved = state.categories?.[cat.id];
  grid.appendChild(buildCard(cat, saved));
});

updateProgress();

document.getElementById('week-date').addEventListener('change', saveState);

document.getElementById('clear-btn').addEventListener('click', () => {
  if (!confirm('Clear all tasks for this week?')) return;
  localStorage.removeItem(STORAGE_KEY);
  document.querySelectorAll('.task-input').forEach(i => i.value = '');
  document.querySelectorAll('input[type="checkbox"]').forEach(c => { c.checked = false; });
  document.querySelectorAll('.task-row').forEach(r => { r.classList.remove('done-row'); });
  document.querySelectorAll('.task-input').forEach(i => i.classList.remove('done-text'));
  document.querySelectorAll('.notes-textarea').forEach(t => { t.value = ''; });
  document.querySelectorAll('.notes-body').forEach(b => b.classList.remove('open'));
  document.querySelectorAll('.notes-toggle').forEach(t => t.classList.remove('open'));
  updateProgress();
});
</script>
</body>
</html>
